---
description: 下書きのレビュー依頼
argument-hint: [postId（省略可）]
---

# レビュー依頼

下書きをレビュー待ち状態に変更します。

## 参照ドキュメント

- @mcp-tools.md

## 使用するMCPツール

| ツール | 用途 |
|--------|------|
| `search_posts` | 下書き（draft）を検索 |
| `get_post` | 下書き内容を確認 |
| `get_component_catalog` | 使用可能なコンポーネント一覧を取得（チェック用） |
| `list_data_types` | データタイプ参照の確認 |
| `get_preview_url` | 最終プレビューを取得 |
| `request_review` | レビュー依頼（status: "review" に変更） |

## 手順

### 1. 対象記事の特定

入力: $ARGUMENTS

```
引数あり？
  ├─ YES → そのpostIdで進む
  └─ NO → search_posts(status: "draft")
              ├─ あり → 「どの下書きをレビュー依頼しますか？」と質問
              └─ なし → 「下書きがありません」で終了
```

### 2. 下書き内容の確認

```
get_post(postId)
→ タイトル・内容を確認

get_preview_url(postId)
→ プレビューURLを取得
```

### 3. 機械チェックリスト

`request_review` の前に、以下の項目を自動チェックする。問題があればユーザーに報告し、修正を提案する。

**必須メタデータの確認:**
- タイトルが設定されているか
- 説明文（description）が設定されているか

**画像のaltテキスト確認:**
- MDX内の画像にaltテキストが設定されているか
- 空のalt属性がないか

**コンポーネントの妥当性確認:**
```
get_component_catalog
→ カタログに存在しないコンポーネントがMDX内で使用されていないか確認
```

**MDXセキュリティ確認:**
- @mdx-security.md の禁止構文（import/export文、JavaScript式、scriptタグ等）に違反していないか

**データタイプ参照の確認:**
```
list_data_types(collectionSlug)
→ コレクションにデータタイプ（著者など）がある場合、記事に紐付けられているか確認
```

**チェック結果の報告例:**
```
レビュー前チェック結果:

- [OK] タイトル: 設定済み
- [OK] 説明文: 設定済み
- [OK] 画像alt: すべて設定済み
- [OK] コンポーネント: すべてカタログに存在
- [OK] MDXセキュリティ: 違反なし
- [注意] データタイプ: 著者が未設定です

→ 著者を設定してからレビュー依頼しますか？
  それともこのまま進めますか？
```

### 4. レビュー依頼前の最終確認

ユーザーに最終確認:

```
以下の記事をレビュー依頼します。

- **タイトル**: {タイトル}
- **プレビュー**: {プレビューURL}

よろしいですか？
```

### 5. レビュー依頼

```
request_review(postId)
→ ステータスを "review" に変更
```

## 出力

```
レビュー依頼が完了しました。

- **postId**: {postId}
- **タイトル**: {タイトル}
- **ステータス**: review

公開は管理画面から行ってください。
```

## 注意事項

- レビュー依頼はAIが実行できる最終アクション
- 公開は必ず人間が管理画面から行う
