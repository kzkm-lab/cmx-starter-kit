---
description: 記事の企画・提案（引数なし→AI提案、引数あり→アイデア整理）
argument-hint: [テーマやアイデア（省略可）]
---

# 記事企画

記事のアイデアを提案・整理します。

## 参照ドキュメント

- @style-guide.md
- @mcp-tools.md

## 使用するMCPツール

| ツール | 用途 |
|--------|------|
| `list_collections` | コレクション一覧と記事数を把握 |
| `search_posts` | 既存記事の取得・重複チェック |
| `get_post` | 必要に応じて記事詳細を確認 |
| `list_data_types` | コレクションのデータタイプ（著者・カテゴリ等）を確認 |
| `list_data_entries` | データタイプのエントリ一覧を取得 |
| `create_draft` | 企画承認後に下書きを作成（`status: "plan"` で企画段階として登録） |

## 手順

### 1. モード判定

- **引数なし** → AI提案モード（既存記事を分析して提案）
- **引数あり** → アイデア整理モード（ユーザーの入力を構造化）

入力: $ARGUMENTS

### 2. 情報収集

```
list_collections
→ コレクション一覧を確認

search_posts(limit: 20)
→ 最近の記事を取得
```

**AI提案モードの場合:**
- 取得した記事の傾向を分析
- カバーされていないトピックを特定
- 深掘り・シリーズ化の可能性を検討

**アイデア整理モードの場合:**
- ユーザー入力に関連するキーワードで `search_posts` を実行
- 類似記事との重複をチェック

### 3. コレクション判別

テーマに最適なコレクションを自動判別する。

### 4. 提案の生成

3つ程度のアイデアを提案する。

## 出力フォーマット

```
## 提案 1: [タイトル案]

- **slug**: `proposed-slug`
- **コレクション**: [判別したコレクション名]
- **概要**: 記事の方向性を2-3文で
- **構成案**:
  - 導入
  - セクション1
  - セクション2
  - まとめ
- **提案理由**: なぜこの記事が有効か
- **関連既存記事**: [参考になる既存記事があれば]
```

## 5. 企画の確定

提案をユーザーに提示し、採用する企画を選んでもらう。

### 承認後の処理

```
create_draft(collectionId, slug, title, description, status: "plan")
→ postId を取得
```

### 6. 著者・カテゴリの事前選択

企画登録後、コレクションにデータタイプ（著者・カテゴリなど）が存在する場合は事前選択を案内する。

```
list_data_types(collectionSlug)
→ コレクションに紐づくデータタイプを確認

データタイプがある場合:
  list_data_entries(collectionSlug, dataTypeSlug)
  → 各データタイプのエントリ一覧を取得
  → ユーザーに著者・カテゴリの選択を提示
```

**案内例:**
```
このコレクションには以下のデータタイプがあります：

- **著者**: 田中太郎, 山田花子, ...
- **カテゴリ**: チュートリアル, ニュース, ...

下書き執筆時に紐付けるので、希望があればお知らせください。
```

## 出力

```
企画を登録しました。

- **postId**: {postId}
- **タイトル**: {タイトル}
- **ステータス**: plan
- **データタイプ**: {利用可能なデータタイプがあれば表示}

下書き執筆は /article/02_draft で続けられます。
```

## 注意事項

- 既存記事と重複しないこと
- コレクションの特性に合った提案をすること
- タイトルは複数案を出す
- 企画は status: "plan" で登録する
